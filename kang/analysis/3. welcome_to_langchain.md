## 3. Welcome to langchain

### 3.0 LLMs and Chat Models

📍**Model**

```python
# OpenAI
model_name: str = Field(default="text-davinci-003", alias="model")

# ChatOpenAI
model_name: str = Field(default="gpt-3.5-turbo", alias="model")
```

- [OpenAI overview](https://platform.openai.com/docs/models/overview)
  - gpt-3.5-turbo: 채팅에 특화된 모델

### 3.1 Predict Messages

📍**Model Parameters**

- temperature: 모델이 얼마나 창의적인지를 결정 (low-보수적, high-창의적, range-(0,1))

📍**Message Type**

- HumanMessage: 나의 질문
- AIMessage: AI에 의해 보내지는 것
  - 대화 기록이라고 보면 편함
- SystemMessage: LLM에 설정을 제공하기 위함
  - AI에 기본 설정, 기본 값 등

### 3.2 Prompt Templates

👀 **Template**

> 프롬프트를 구조화하고 텍스트 생성 모델에 전달하기 위해 사용하는 템플릿

📍**Template Type**

- ChatPromptTemplate: message ☞ template
- PromptTemplate: string ☞ template

### 3.3 OutputParser and LCEL

📍**Output Parser**

```python
class Parser(BaseOutputParser):

    def parse(self, text):
        return text
```

- parser class 생성
- BaseOutputParser 상속
- parse는 BaseOutputParser의 abstract method
  - class에서 재정의 수행

📌**Output Parser가 필요한 이유**

- LLM의 응답을 변형해야 할 때가 있음
  - (ex) 응답을 dictionary, list 등 적용점에 따라 바꿔야할 경우

📍**LCEL**

- chain
  - 여러 요소들을 묶어서 하나의 실행처럼 보이게 함
- invoke
  - chain의 실행 method
  - dictionary type이 input으로 들어가야함

### 3.4 Chaining Chains

❤️‍🔥 **interface**

- [langchain interface](https://python.langchain.com/v0.1/docs/expression_language/interface/#input-schema)

| Component    | Input Type                                            | Output Type           |
| ------------ | ----------------------------------------------------- | --------------------- |
| Prompt       | Dictionary                                            | PromptValue           |
| ChatModel    | Single string, list of chat messages or a PromptValue | ChatMessage           |
| LLM          | Single string, list of chat messages or a PromptValue | String                |
| OutputParser | The output of an LLM or ChatModel                     | Depends on the parser |
| Retriever    | Single string                                         | List of Documents     |
| Tool         | Single string or dictionary, depending on the tool    | Depends on the tool   |

🌈 **Example**

```python
chain = template | chat | p

chain.invoke({
    "max_items": 5,
    "question": "What are the pokemons?"
})
```

1. invoke
2. template
   - input: dictionary
   - output: promt value
3. chat
   - input: prompt value
   - output: chat message
4. outputparser
   - input: chat message
